(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15824,        422]
NotebookOptionsPosition[     14729,        378]
NotebookOutlinePosition[     15074,        393]
CellTagsIndexPosition[     15031,        390]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Problem 8", "Title",
 CellChangeTimes->{{3.518443285082255*^9, 3.518443286698347*^9}, {
   3.519534413745219*^9, 3.5195344265489516`*^9}, 3.519693898795706*^9}],

Cell[TextData[{
 "Find the greatest product of five consecutive digits in the 1000-digit \
number.\n\n",
 Cell[BoxData[{
  FormBox[
  "73167176531330624919225119674426574742355349194934", 
   TraditionalForm], "\n", 
  FormBox[
  "96983520312774506326239578318016984801869478851843", 
   TraditionalForm], "\n", 
  FormBox[
  "85861560789112949495459501737958331952853208805511", 
   TraditionalForm], "\n", 
  FormBox[
  "12540698747158523863050715693290963295227443043557", 
   TraditionalForm], "\n", 
  FormBox[
  "66896648950445244523161731856403098711121722383113", 
   TraditionalForm], "\n", 
  FormBox[
  "62229893423380308135336276614282806444486645238749", 
   TraditionalForm], "\n", 
  FormBox[
  "30358907296290491560440772390713810515859307960866", 
   TraditionalForm], "\n", 
  FormBox[
  "70172427121883998797908792274921901699720888093776", 
   TraditionalForm], "\n", 
  FormBox[
  "65727333001053367881220235421809751254540594752243", 
   TraditionalForm], "\n", 
  FormBox[
  "52584907711670556013604839586446706324415722155397", 
   TraditionalForm], "\n", 
  FormBox[
  "53697817977846174064955149290862569321978468622482", 
   TraditionalForm], "\n", 
  FormBox[
  "83972241375657056057490261407972968652414535100474", 
   TraditionalForm], "\n", 
  FormBox[
  "82166370484403199890008895243450658541227588666881", 
   TraditionalForm], "\n", 
  FormBox[
  "16427171479924442928230863465674813919123162824586", 
   TraditionalForm], "\n", 
  FormBox[
  "17866458359124566529476545682848912883142607690042", 
   TraditionalForm], "\n", 
  FormBox[
  "24219022671055626321111109370544217506941658960408", 
   TraditionalForm], "\n", 
  FormBox[
  "07198403850962455444362981230987879927244284909188", 
   TraditionalForm], "\n", 
  FormBox[
  "84580156166097919133875499200524063689912560717606", 
   TraditionalForm], "\n", 
  FormBox[
  "05886116467109405077541002256983155200055935729725", 
   TraditionalForm], "\n", 
  FormBox[
  "71636269561882670428252483600823257530420752963450", TraditionalForm]}]]
}], "Text",
 CellChangeTimes->{{3.518443299288068*^9, 3.5184433268916464`*^9}}],

Cell[CellGroupData[{

Cell["Original Solution", "Section",
 CellChangeTimes->{{3.5196939102123585`*^9, 3.5196939139155703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"number", ",", " ", "products"}], "}"}], ",", 
    RowBox[{
     RowBox[{"number", "=", 
      RowBox[{"IntegerDigits", "[", 
       FormBox[
        "731671765313306249192251196744265747423553491949349698352031277450632\
623957831801698480186947885184385861560789112949495459501737958331952853208805\
511125406987471585238630507156932909632952274430435576689664895044524452316173\
185640309871112172238311362229893423380308135336276614282806444486645238749303\
589072962904915604407723907138105158593079608667017242712188399879790879227492\
190169972088809377665727333001053367881220235421809751254540594752243525849077\
116705560136048395864467063244157221553975369781797784617406495514929086256932\
197846862248283972241375657056057490261407972968652414535100474821663704844031\
998900088952434506585412275886668811642717147992444292823086346567481391912316\
282458617866458359124566529476545682848912883142607690042242190226710556263211\
111093705442175069416589604080719840385096245544436298123098787992724428490918\
884580156166097919133875499200524063689912560717606058861164671094050775410022\
5698315520005593572972571636269561882670428252483600823257530420752963450",
        TraditionalForm], "]"}]}], ";", " ", 
     RowBox[{"products", "=", 
      RowBox[{"{", "0", "}"}]}], ";", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"products", ",", " ", 
         RowBox[{
          RowBox[{"number", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "*", 
          RowBox[{"number", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
          RowBox[{"number", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "2"}], "]"}], "]"}], "*", 
          RowBox[{"number", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "3"}], "]"}], "]"}], "*", 
          RowBox[{"number", "[", 
           RowBox[{"[", 
            RowBox[{"i", "+", "4"}], "]"}], "]"}]}]}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"IntegerDigits", "[", "number", "]"}], "]"}], " ", "-", 
          "4"}]}], "}"}]}], "]"}], ";", "  ", 
     RowBox[{"Max", "[", "products", "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5184433379622793`*^9, 3.5184433498649607`*^9}, {
  3.5184437824087005`*^9, 3.518443805177003*^9}, {3.5184450802144313`*^9, 
  3.5184451724667077`*^9}, {3.5184460025811872`*^9, 3.5184460048963203`*^9}, {
  3.5195343761580696`*^9, 3.5195343814803743`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.04700000000000372`", ",", "40824"}], "}"}]], "Output",
 CellChangeTimes->{{3.518445110547166*^9, 3.5184451322244062`*^9}, {
   3.5184451740467978`*^9, 3.5184451792720966`*^9}, 3.5195343846475554`*^9, 
   3.5196939527957945`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Alternate Solution", "Section",
 CellChangeTimes->{{3.518446066842863*^9, 3.518446074210284*^9}}],

Cell["\<\
Based on pwyll\[CloseCurlyQuote]s solution on the Project Euler website. The \
@@@ means Apply at level 1, so it is applying the function Times to each \
group which are in the groups array as { {1,2,3,4,5}, {6,7,8,9,10} }.\
\>", "Text",
 CellChangeTimes->{{3.5184456203233232`*^9, 3.518445719553999*^9}, {
  3.5184459454139175`*^9, 3.5184459492931395`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "number", "}"}], ",", " ", 
    RowBox[{
     RowBox[{"number", " ", "=", " ", 
      FormBox[
       "7316717653133062491922511967442657474235534919493496983520312774506326\
239578318016984801869478851843858615607891129494954595017379583319528532088055\
111254069874715852386305071569329096329522744304355766896648950445244523161731\
856403098711121722383113622298934233803081353362766142828064444866452387493035\
890729629049156044077239071381051585930796086670172427121883998797908792274921\
901699720888093776657273330010533678812202354218097512545405947522435258490771\
167055601360483958644670632441572215539753697817977846174064955149290862569321\
978468622482839722413756570560574902614079729686524145351004748216637048440319\
989000889524345065854122758866688116427171479924442928230863465674813919123162\
824586178664583591245665294765456828489128831426076900422421902267105562632111\
110937054421750694165896040807198403850962455444362981230987879927244284909188\
845801561660979191338754992005240636899125607176060588611646710940507754100225\
698315520005593572972571636269561882670428252483600823257530420752963450",
       TraditionalForm]}], ";", " ", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"groups", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"IntegerDigits", "[", "number", "]"}], ",", " ", "5", ",", 
           " ", "1"}], "]"}]}], "}"}], ",", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Times", " ", "@@@", " ", "groups"}], "]"}]}], "]"}]}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.518445951833285*^9, 3.51844600769748*^9}, {
  3.519693937613926*^9, 3.5196939448373394`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "40824"}], "}"}]], "Output",
 CellChangeTimes->{3.518446010915664*^9, 3.519693946233419*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Optimization", "Section",
 CellChangeTimes->{{3.519693968411688*^9, 3.519693969954776*^9}}],

Cell["\<\
Use Table instead of Do so we can take Max directly.\
\>", "Text",
 CellChangeTimes->{{3.519694195523678*^9, 3.519694210467532*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "number", "}"}], ",", 
    RowBox[{
     RowBox[{"number", "=", 
      RowBox[{"IntegerDigits", "[", 
       FormBox[
        "731671765313306249192251196744265747423553491949349698352031277450632\
623957831801698480186947885184385861560789112949495459501737958331952853208805\
511125406987471585238630507156932909632952274430435576689664895044524452316173\
185640309871112172238311362229893423380308135336276614282806444486645238749303\
589072962904915604407723907138105158593079608667017242712188399879790879227492\
190169972088809377665727333001053367881220235421809751254540594752243525849077\
116705560136048395864467063244157221553975369781797784617406495514929086256932\
197846862248283972241375657056057490261407972968652414535100474821663704844031\
998900088952434506585412275886668811642717147992444292823086346567481391912316\
282458617866458359124566529476545682848912883142607690042242190226710556263211\
111093705442175069416589604080719840385096245544436298123098787992724428490918\
884580156166097919133875499200524063689912560717606058861164671094050775410022\
5698315520005593572972571636269561882670428252483600823257530420752963450",
        TraditionalForm], "]"}]}], ";", 
     RowBox[{"Max", "[", 
      RowBox[{"Table", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"number", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "*", 
         RowBox[{"number", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
         RowBox[{"number", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "2"}], "]"}], "]"}], "*", 
         RowBox[{"number", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "3"}], "]"}], "]"}], "*", 
         RowBox[{"number", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "4"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "1", ",", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"IntegerDigits", "[", "number", "]"}], "]"}], " ", "-", 
           "4"}]}], "}"}]}], "]"}], "]"}]}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5196939760011215`*^9, 3.519694031669306*^9}, 
   3.5196943185157127`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "40824"}], "}"}]], "Output",
 CellChangeTimes->{3.519694033056385*^9, 3.5196943202508116`*^9}]
}, Open  ]],

Cell["\<\
Store only the maximum instead of an entire table.\
\>", "Text",
 CellChangeTimes->{{3.51969423665103*^9, 3.519694243715434*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"number", ",", "max"}], "}"}], ",", 
    RowBox[{
     RowBox[{"number", "=", 
      RowBox[{"IntegerDigits", "[", 
       FormBox[
        "731671765313306249192251196744265747423553491949349698352031277450632\
623957831801698480186947885184385861560789112949495459501737958331952853208805\
511125406987471585238630507156932909632952274430435576689664895044524452316173\
185640309871112172238311362229893423380308135336276614282806444486645238749303\
589072962904915604407723907138105158593079608667017242712188399879790879227492\
190169972088809377665727333001053367881220235421809751254540594752243525849077\
116705560136048395864467063244157221553975369781797784617406495514929086256932\
197846862248283972241375657056057490261407972968652414535100474821663704844031\
998900088952434506585412275886668811642717147992444292823086346567481391912316\
282458617866458359124566529476545682848912883142607690042242190226710556263211\
111093705442175069416589604080719840385096245544436298123098787992724428490918\
884580156166097919133875499200524063689912560717606058861164671094050775410022\
5698315520005593572972571636269561882670428252483600823257530420752963450",
        TraditionalForm], "]"}]}], ";", " ", 
     RowBox[{"max", "=", "0"}], ";", 
     RowBox[{"Do", "[", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"number", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "2"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "3"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "4"}], "]"}], "]"}]}], " ", ">", " ", "max"}], 
         ",", 
         RowBox[{"max", "=", 
          RowBox[{
           RowBox[{"number", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "2"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "3"}], "]"}], "]"}], "*", 
           RowBox[{"number", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "4"}], "]"}], "]"}]}]}], " ", ",", 
         "Continue"}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"IntegerDigits", "[", "number", "]"}], "]"}], " ", "-", 
          "4"}]}], "}"}]}], "]"}], ";", "max"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5196939760011215`*^9, 3.519694031669306*^9}, {
  3.5196942482956963`*^9, 3.519694313438422*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.031000000000003733`", ",", "40824"}], "}"}]], "Output",
 CellChangeTimes->{3.519694033056385*^9, 3.51969432302397*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{707, 655},
WindowMargins->{{Automatic, 37}, {Automatic, 25}},
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 166, 2, 83, "Title"],
Cell[748, 26, 2111, 64, 442, "Text"],
Cell[CellGroupData[{
Cell[2884, 94, 106, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[3015, 99, 2686, 55, 432, "Input"],
Cell[5704, 156, 270, 5, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6023, 167, 103, 1, 71, "Section"],
Cell[6129, 170, 368, 6, 47, "Text"],
Cell[CellGroupData[{
Cell[6522, 180, 1796, 34, 392, "Input"],
Cell[8321, 216, 143, 3, 30, "Output"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[8513, 225, 97, 1, 41, "Section"],
Cell[8613, 228, 142, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[8780, 235, 2288, 48, 432, "Input"],
Cell[11071, 285, 145, 3, 30, "Output"]
}, Open  ]],
Cell[11231, 291, 139, 3, 29, "Text"],
Cell[CellGroupData[{
Cell[11395, 298, 3131, 70, 452, "Input"],
Cell[14529, 370, 160, 3, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

