(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12049,        397]
NotebookOptionsPosition[     10931,        353]
NotebookOutlinePosition[     11299,        369]
CellTagsIndexPosition[     11256,        366]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Problem 44", "Title",
 CellChangeTimes->{{3.5189691074315615`*^9, 3.518969110231722*^9}, {
   3.519535014053555*^9, 3.5195350157696533`*^9}, 3.5197772508863564`*^9}],

Cell[CellGroupData[{

Cell["Problem", "Section",
 CellChangeTimes->{{3.519777255735633*^9, 3.5197772564066715`*^9}}],

Cell[TextData[{
 "Pentagonal numbers are generated by the formula, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"P", "(", "n", ")"}], "=", 
    RowBox[{
     RowBox[{"n", "(", 
      RowBox[{
       RowBox[{"3", "n"}], "+", "1"}], ")"}], "/", "2"}]}], TraditionalForm]]],
 ". The first ten pentagonal numbers are:\n\n",
 StyleBox["1, 5, 12, 22, 35, 51, 70, 92, 117, 145, ...\n", "Output"],
 "\nIt can be seen that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"P", "(", "4", ")"}], "+", 
     RowBox[{"P", "(", "7", ")"}]}], "=", 
    RowBox[{
     RowBox[{"22", "+", "70"}], "=", 
     RowBox[{"92", "=", 
      RowBox[{"P", "(", "8", ")"}]}]}]}], TraditionalForm]]],
 " . However, their difference, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"70", "-", "22"}], "=", "48"}], TraditionalForm]]],
 ", is not pentagonal.\n\nFind the pair of pentagonal numbers, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "j", ")"}], TraditionalForm]]],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"P", "(", "k", ")"}], TraditionalForm]]],
 ", for which their sum and difference is pentagonal and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"D", "=", 
    RowBox[{"|", 
     RowBox[{
      RowBox[{"P", "(", "k", ")"}], "-", 
      RowBox[{"P", "(", "j", ")"}]}], "|"}]}], TraditionalForm]]],
 " is minimised; what is the value of ",
 Cell[BoxData[
  FormBox["D", TraditionalForm]]],
 "?"
}], "Text",
 CellChangeTimes->{{3.518969128341758*^9, 3.518969242571291*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Original Solution", "Section",
 CellChangeTimes->{{3.519762950729495*^9, 3.5197629530806293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pent", ",", "pentQ"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"pent", "[", "n_", "]"}], "=", 
      RowBox[{"n", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
     RowBox[{
      RowBox[{"pentQ", "[", "x_", "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "6"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{"24", "x"}]}], "]"}]}], ")"}]}]}], ";", 
     RowBox[{"Catch", "[", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "+", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "-", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"Throw", "[", 
           RowBox[{"{", 
            RowBox[{"k", ",", "j", ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"pent", "[", "k", "]"}], "-", 
               RowBox[{"pent", "[", "j", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          "Continue"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "10000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "10000"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5189586256050353`*^9, 3.5189588833997803`*^9}, {
  3.518958928338351*^9, 3.5189589366578264`*^9}, {3.5189590495242825`*^9, 
  3.5189590711195173`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1302.25`", ",", 
   RowBox[{"{", 
    RowBox[{"2167", ",", "1020", ",", "5482660"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5189589235660777`*^9, 3.5189589771001396`*^9, 
  3.5189603995745006`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Optimization", "Section",
 CellChangeTimes->{{3.5197772753267536`*^9, 3.5197772769498463`*^9}}],

Cell["\<\
Since I have the answer already I\[CloseCurlyQuote]m going to reduce the \
range being checked (otherwise I could end up sitting here forever) to 1 to \
5000.\
\>", "Text",
 CellChangeTimes->{{3.5197773078216124`*^9, 3.519777333951107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pent", ",", "pentQ"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"pent", "[", "n_", "]"}], "=", 
      RowBox[{"n", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
     RowBox[{
      RowBox[{"pentQ", "[", "x_", "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "6"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{"24", "x"}]}], "]"}]}], ")"}]}]}], ";", 
     RowBox[{"Catch", "[", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "+", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "-", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"Throw", "[", 
           RowBox[{"{", 
            RowBox[{"k", ",", "j", ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"pent", "[", "k", "]"}], "-", 
               RowBox[{"pent", "[", "j", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          "Continue"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "5000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5000"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5197772882044907`*^9, 3.519777294853871*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"418.238`", ",", 
   RowBox[{"{", 
    RowBox[{"2167", ",", "1020", ",", "5482660"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5197777265135603`*^9}]
}, Open  ]],

Cell["ParallelDo vs Do", "Text",
 CellChangeTimes->{{3.5197773593895617`*^9, 3.5197773632217813`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pent", ",", "pentQ"}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"pent", "[", "n_", "]"}], "=", 
      RowBox[{"n", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}]}], ";", 
     RowBox[{
      RowBox[{"pentQ", "[", "x_", "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "6"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"1", "+", 
           RowBox[{"24", "x"}]}], "]"}]}], ")"}]}]}], ";", 
     RowBox[{"Catch", "[", 
      RowBox[{"ParallelDo", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "+", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}], "&&", 
           RowBox[{"IntegerQ", "[", 
            RowBox[{"pentQ", "[", 
             RowBox[{
              RowBox[{"pent", "[", "k", "]"}], "-", 
              RowBox[{"pent", "[", "j", "]"}]}], "]"}], "]"}]}], ",", 
          RowBox[{"Throw", "[", 
           RowBox[{"{", 
            RowBox[{"k", ",", "j", ",", 
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"pent", "[", "k", "]"}], "-", 
               RowBox[{"pent", "[", "j", "]"}]}], "]"}]}], "}"}], "]"}], ",", 
          "Continue"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", "1", ",", "5000"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "5000"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5197772882044907`*^9, 3.519777294853871*^9}, {
  3.5197773443627024`*^9, 3.5197773453747606`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Throw", "::", "nocatch"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Uncaught \\!\\(Throw[\\(\\({2167, 1020, 5482660}\\)\\)]\\) \
returned to top level.\"\>"}]], "Message", "MSG",
 ShowCellLabel->True,
 CellChangeTimes->{3.519778098802854*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Parallel`Developer`QueueRun", "::", "hmm"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Received unexpected result \
\[NoBreak]\\!\\(Hold[\\(\\(Throw[\\(\\({2167, 1020, 5482660}\\)\\)]\\)\\)]\\)\
\[NoBreak] from \[NoBreak]\\!\\(KernelObject[\\(\\(2, \\\"local\\\"\\)\\)]\\)\
\[NoBreak].\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.519778102385059*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.5197781786394205`*^9}]
}, Open  ]],

Cell["\<\
Lets work on the functions being used.\
\>", "Text",
 CellChangeTimes->{{3.5197774873418803`*^9, 3.5197774936612415`*^9}}],

Cell[BoxData[{
 RowBox[{"pentQ", ":=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"IntegerQ", "[", 
     RowBox[{
      RowBox[{"1", "/", "6"}], 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{"24", "x"}]}], "]"}]}], ")"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{"pent", ":=", 
   RowBox[{"Compile", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"n", ",", "_Integer"}], "}"}], "}"}], ",", 
     RowBox[{"n", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.5197774958783684`*^9, 3.5197776023294573`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{707, 655},
WindowMargins->{{Automatic, -920}, {Automatic, -3}},
ShowSelection->True,
FrontEndVersion->"8.0 for Microsoft Windows (32-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 171, 2, 83, "Title"],
Cell[CellGroupData[{
Cell[775, 28, 94, 1, 71, "Section"],
Cell[872, 31, 1491, 49, 155, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2400, 85, 104, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[2529, 90, 1923, 54, 132, "Input"],
Cell[4455, 146, 246, 6, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4750, 158, 101, 1, 71, "Section"],
Cell[4854, 161, 250, 5, 47, "Text"],
Cell[CellGroupData[{
Cell[5129, 170, 1815, 52, 112, "Input"],
Cell[6947, 224, 195, 5, 30, "Output"]
}, Open  ]],
Cell[7157, 232, 102, 1, 29, "Text"],
Cell[CellGroupData[{
Cell[7284, 237, 1876, 53, 132, "Input"],
Cell[9163, 292, 296, 8, 21, "Message"],
Cell[9462, 302, 407, 9, 39, "Message"],
Cell[9872, 313, 79, 1, 30, "Output"]
}, Open  ]],
Cell[9966, 317, 132, 3, 29, "Text"],
Cell[10101, 322, 802, 27, 52, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
